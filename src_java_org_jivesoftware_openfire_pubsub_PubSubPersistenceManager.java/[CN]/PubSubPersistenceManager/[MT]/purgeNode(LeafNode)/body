{
  Connection con=null;
  boolean rollback=false;
  try {
    con=DbConnectionManager.getTransactionConnection();
    purgeNode(leafNode,con);
synchronized (itemsPending) {
      Iterator<Map.Entry<String,LinkedListNode>> pendingIt=itemsPending.entrySet().iterator();
      while (pendingIt.hasNext()) {
        LinkedListNode itemNode=pendingIt.next().getValue();
        if (((PublishedItem)itemNode.object).getNodeID().equals(leafNode.getNodeID())) {
          itemNode.remove();
          pendingIt.remove();
        }
      }
    }
  }
 catch (  SQLException exc) {
    log.error(exc.getMessage(),exc);
    rollback=true;
  }
 finally {
    DbConnectionManager.closeTransactionConnection(con,rollback);
  }
}
