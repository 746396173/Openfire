{
  String username=sender.getName().toLowerCase();
  sessionLock.writeLock().lock();
  try {
    SessionMap resources=(SessionMap)sessions.get(username);
    if (resources == null) {
      return;
    }
    resources.changePriority(sender,priority);
    Session defaultSession=resources.getDefaultSession();
    routingTable.addRoute(new XMPPAddress(defaultSession.getAddress().getNamePrep(),defaultSession.getAddress().getHostPrep(),""),defaultSession);
  }
  finally {
    sessionLock.writeLock().unlock();
  }
}
