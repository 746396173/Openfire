{
  if (connectionPool == null) {
synchronized (initLock) {
      if (connectionPool == null) {
        Log.error("DbConnectionDefaultPool.getConnection() was " + "called before the internal pool has been initialized or " + "there was a problem connecting to the database.");
        if ("true".equals(JiveGlobals.getXMLProperty("setup"))) {
          this.restart();
          if (connectionPool == null) {
            Log.error("Recovery logic failed to reconnect to the database.");
            return null;
          }
        }
 else {
          return null;
        }
      }
    }
  }
  return connectionPool.getConnection();
}
