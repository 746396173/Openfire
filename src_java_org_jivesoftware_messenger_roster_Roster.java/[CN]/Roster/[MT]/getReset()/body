{
  org.xmpp.packet.Roster roster=new org.xmpp.packet.Roster();
  for (  RosterItem item : rosterItems.values()) {
    org.xmpp.packet.Roster.Ask ask=getAskStatus(item.getAskStatus());
    org.xmpp.packet.Roster.Subscription sub=org.xmpp.packet.Roster.Subscription.valueOf(item.getSubStatus().getName());
    List<String> groups=new ArrayList<String>(item.getGroups());
    for (    Group sharedGroup : item.getSharedGroups()) {
      groups.add(sharedGroup.getProperties().get("sharedRoster.displayName"));
    }
    if (item.getSubStatus() != RosterItem.SUB_NONE || item.getAskStatus() != RosterItem.ASK_NONE) {
      roster.addItem(item.getJid(),item.getNickname(),ask,sub,groups);
    }
  }
  return roster;
}
