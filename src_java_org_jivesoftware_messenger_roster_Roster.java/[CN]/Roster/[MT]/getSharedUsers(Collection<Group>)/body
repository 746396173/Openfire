{
  Map<JID,List<String>> sharedGroupUsers=new HashMap<JID,List<String>>();
  for (  Group group : sharedGroups) {
    Collection<String> users=new ArrayList<String>(group.getMembers());
    users.addAll(group.getAdmins());
    for (    String groupUser : users) {
      JID jid=XMPPServer.getInstance().createJID(groupUser,null);
      if (!isRosterItem(jid) && !getUsername().equals(groupUser)) {
        List<String> groups=sharedGroupUsers.get(jid);
        if (groups == null) {
          groups=new ArrayList<String>();
          sharedGroupUsers.put(jid,groups);
        }
        groups.add(group.getProperties().get("displayName"));
      }
    }
  }
  return sharedGroupUsers;
}
