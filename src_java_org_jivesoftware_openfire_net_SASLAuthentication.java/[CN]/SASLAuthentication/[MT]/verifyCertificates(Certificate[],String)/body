{
  try {
    X509Certificate trusted=CertificateManager.getEndEntityCertificate(chain,SSLConfig.getKeyStore(),SSLConfig.gets2sTrustStore());
    if (trusted != null) {
      for (      String identity : CertificateManager.getPeerIdentities(trusted)) {
        if ((identity.startsWith("*.") && (hostname.endsWith(identity.replace("*.",".")) || hostname.equals(identity.replace("*.","")))) || hostname.equals(identity)) {
          return true;
        }
      }
    }
  }
 catch (  IOException e) {
    Log.warn("Keystore issue while verifying certificate chain: {}",e.getMessage());
  }
  return false;
}
