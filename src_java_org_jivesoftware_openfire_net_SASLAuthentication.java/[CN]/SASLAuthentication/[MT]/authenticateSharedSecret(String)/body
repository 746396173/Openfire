{
  if (!isSharedSecretAllowed()) {
    return false;
  }
  String sharedSecert=getSharedSecret();
  return StringUtils.hash(sharedSecert).equals(digest);
}
