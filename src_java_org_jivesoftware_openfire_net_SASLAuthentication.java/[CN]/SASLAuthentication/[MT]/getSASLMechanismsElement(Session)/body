{
  if (!(session instanceof ClientSession) && !(session instanceof IncomingServerSession)) {
    return null;
  }
  Element mechs=DocumentHelper.createElement(new QName("mechanisms",new Namespace("","urn:ietf:params:xml:ns:xmpp-sasl")));
  if (session instanceof IncomingServerSession) {
    if (session.isSecure()) {
      Element mechanism=mechs.addElement("mechanism");
      mechanism.setText("EXTERNAL");
    }
  }
 else {
    for (    String mech : getSupportedMechanisms()) {
      Element mechanism=mechs.addElement("mechanism");
      mechanism.setText(mech);
    }
  }
  return mechs;
}
