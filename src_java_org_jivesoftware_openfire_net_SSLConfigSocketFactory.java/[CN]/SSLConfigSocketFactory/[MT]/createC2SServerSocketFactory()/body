{
  final IdentityStoreConfig identityStoreConfig=(IdentityStoreConfig)SSLConfig.getInstance().getStoreConfig(Purpose.SOCKETBASED_IDENTITYSTORE);
  final TrustStoreConfig trustStoreConfig=(TrustStoreConfig)SSLConfig.getInstance().getStoreConfig(Purpose.SOCKETBASED_C2S_TRUSTSTORE);
  final String algorithm=JiveGlobals.getProperty(ConnectionSettings.Client.TLS_ALGORITHM,"TLS");
  final SSLContext context=SSLContext.getInstance(algorithm);
  context.init(identityStoreConfig.getKeyManagers(),trustStoreConfig.getTrustManagers(),new java.security.SecureRandom());
  return context.getServerSocketFactory();
}
