{
  String awayMsg=((IRCTransport)getTransport()).convertJabStatusToIRC(presenceType,verboseStatus);
  if (awayMsg == null) {
    conn.doAway();
    if (getTransport().getLegacyMode()) {
      Presence p=new Presence();
      p.setTo(getJID());
      p.setFrom(getTransport().getJID());
      getTransport().sendPacket(p);
    }
  }
 else {
    conn.doAway(awayMsg);
    if (getTransport().getLegacyMode()) {
      Presence p=new Presence();
      p.setShow(Presence.Show.away);
      p.setTo(getJID());
      p.setFrom(getTransport().getJID());
      getTransport().sendPacket(p);
    }
  }
}
