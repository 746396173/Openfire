{
  Hashtable<String,String> searchList=new Hashtable<String,String>();
  Element form=incomingForm.element(QName.get("x","jabber:x:data"));
  if (form == null) {
    Element name=incomingForm.element("name");
    if (name != null) {
      searchList.put("Name",name.getTextTrim());
    }
    Element nick=incomingForm.element("nick");
    if (nick != null) {
      searchList.put("Username",nick.getTextTrim());
    }
    Element first=incomingForm.element("first");
    if (first != null) {
      searchList.put("Name",first.getTextTrim());
    }
    Element last=incomingForm.element("last");
    if (last != null) {
      searchList.put("Name",last.getTextTrim());
    }
    Element email=incomingForm.element("email");
    if (email != null) {
      searchList.put("Email",email.getTextTrim());
    }
  }
 else {
    Iterator fields=form.elementIterator("field");
    while (fields.hasNext()) {
      Element searchField=(Element)fields.next();
      Iterator iter=searchField.elementIterator("value");
      while (iter.hasNext()) {
        Element queryField=(Element)iter.next();
        String query=queryField.getTextTrim();
        searchList.put(searchField.attributeValue("var"),query);
      }
    }
  }
  return searchList;
}
