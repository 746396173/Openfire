{
  DirContext ctx=null;
  try {
    Hashtable env=new Hashtable();
    env.put(Context.INITIAL_CONTEXT_FACTORY,"com.sun.jndi.ldap.LdapCtxFactory");
    if (sslEnabled) {
      env.put("java.naming.ldap.factory.socket","org.jivesoftware.util.ssl.DummySSLSocketFactory");
      env.put(Context.SECURITY_PROTOCOL,"ssl");
    }
    env.put(Context.PROVIDER_URL,"ldap://" + host + ":"+ port+ "/"+ baseDN);
    env.put(Context.SECURITY_AUTHENTICATION,"simple");
    env.put(Context.SECURITY_PRINCIPAL,userDN + "," + baseDN);
    env.put(Context.SECURITY_CREDENTIALS,password);
    if (debugEnabled) {
      env.put("com.sun.jndi.ldap.trace.ber",System.err);
    }
    ctx=new InitialDirContext(env);
  }
 catch (  NamingException ne) {
    return false;
  }
 finally {
    try {
      ctx.close();
    }
 catch (    Exception e) {
    }
  }
  return true;
}
