{
  if (!isLoggedIn() && !loggingIn && loginAttempts <= 3) {
    loggingIn=true;
    new Thread(){
      public void run(){
        try {
          loginAttempts++;
          yahooSession.login(registration.getUsername(),registration.getPassword());
          loggedIn=true;
          Presence p=new Presence();
          p.setTo(registration.getJID());
          p.setFrom(getTransport().getJID());
          getTransport().sendPacket(p);
        }
 catch (        LoginRefusedException e) {
          yahooSession.reset();
          Log.warn("Yahoo login failed for " + registration.getJID());
        }
catch (        IOException e) {
          Log.error("Yahoo login caused IO exception: " + e.toString());
        }
        loggingIn=false;
      }
    }
.run();
  }
}
