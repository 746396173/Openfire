{
  Byte[] encodedFrame=null;
  boolean isKeyframe=false;
  try {
    RTPPacket packet=RTPPacket.parseBytes(BitAssistant.bytesToArray(data));
    if (packet != null) {
      Vp8Packet packet2=Vp8Packet.parse(packet.getPayload());
      if (packet2 == null)       return;
      vp8Accumulator.add(packet2);
      if (packet.getMarker().booleanValue()) {
        encodedFrame=Vp8Packet.depacketize(vp8Accumulator.getPackets());
        isKeyframe=isKeyFrame(BitAssistant.bytesFromArray(encodedFrame)).booleanValue();
        vp8Accumulator.reset();
      }
      if (recorder != null && encodedFrame != null) {
        Log.info("Video media " + " " + packet.getPayloadType() + " "+ encodedFrame+ " "+ packet.getTimestamp()+ " "+ isKeyframe);
        recorder.write(BitAssistant.bytesFromArray(encodedFrame),0,encodedFrame.length,isKeyframe,packet.getTimestamp());
      }
    }
 else {
      Log.error("recordVideo cannot parse packet data " + data);
    }
  }
 catch (  Exception e) {
    Log.error("Error writing video recording",e);
  }
}
