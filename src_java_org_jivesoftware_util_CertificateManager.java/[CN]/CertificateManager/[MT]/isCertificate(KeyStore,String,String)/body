{
  boolean result=false;
  for (Enumeration<String> aliases=ksKeys.aliases(); aliases.hasMoreElements(); ) {
    X509Certificate certificate=(X509Certificate)ksKeys.getCertificate(aliases.nextElement());
    if ("*".equals(domain)) {
      if (certificate.getPublicKey().getAlgorithm().equals(algorithm)) {
        result=true;
      }
    }
 else {
      for (      String identity : getServerPeerIdentities(certificate)) {
        if (identity.endsWith(domain) && certificate.getPublicKey().getAlgorithm().equals(algorithm)) {
          result=true;
        }
      }
    }
  }
  Log.debug("Check for certificate for '{}' using algorithm {} returned: {}",new Object[]{domain,algorithm,result});
  return result;
}
