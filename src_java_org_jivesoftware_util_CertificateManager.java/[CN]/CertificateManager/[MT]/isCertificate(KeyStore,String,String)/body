{
  for (Enumeration<String> aliases=ksKeys.aliases(); aliases.hasMoreElements(); ) {
    X509Certificate certificate=(X509Certificate)ksKeys.getCertificate(aliases.nextElement());
    if ("*".equals(domain)) {
      if (certificate.getPublicKey().getAlgorithm().equals(algorithm)) {
        return true;
      }
    }
 else {
      for (      String identity : getPeerIdentities(certificate)) {
        if (identity.endsWith(domain) && certificate.getPublicKey().getAlgorithm().equals(algorithm)) {
          return true;
        }
      }
    }
  }
  return false;
}
