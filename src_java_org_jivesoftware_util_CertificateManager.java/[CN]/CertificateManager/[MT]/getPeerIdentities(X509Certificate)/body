{
  List<String> names=getSubjectAlternativeNames(x509Certificate);
  if (names.isEmpty()) {
    String name=x509Certificate.getSubjectDN().getName();
    Matcher matcher=cnPattern.matcher(name);
    names=new ArrayList<String>();
    while (matcher.find()) {
      names.add(matcher.group(2));
    }
  }
  return names;
}
