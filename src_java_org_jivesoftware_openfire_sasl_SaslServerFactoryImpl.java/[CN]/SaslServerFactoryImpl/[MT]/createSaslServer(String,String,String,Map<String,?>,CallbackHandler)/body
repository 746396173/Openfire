{
  if (mechanism.equals(myMechs[PLAIN]) && checkPolicy(props)) {
    if (cbh == null) {
      throw new SaslException("CallbackHandler with support for Password, Name, and AuthorizeCallback required");
    }
    return new SaslServerPlainImpl(protocol,serverName,props,cbh);
  }
 else   if (mechanism.equals(myMechs[SCRAM_SHA_1])) {
    if (cbh == null) {
      throw new SaslException("CallbackHandler with support for AuthorizeCallback required");
    }
    return new ScramSha1SaslServer();
  }
  return null;
}
