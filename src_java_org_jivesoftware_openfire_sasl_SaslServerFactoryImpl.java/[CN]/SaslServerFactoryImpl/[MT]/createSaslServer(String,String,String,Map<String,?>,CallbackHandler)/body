{
  if (mechanism.equals(myMechs[PLAIN]) && PolicyUtils.checkPolicy(mechPolicies[PLAIN],props)) {
    if (cbh == null) {
      throw new SaslException("CallbackHandler with support for Password, Name, and AuthorizeCallback required");
    }
    return new SaslServerPlainImpl(protocol,serverName,props,cbh);
  }
 else   if (mechanism.equals(myMechs[CLEARSPACE]) && PolicyUtils.checkPolicy(mechPolicies[CLEARSPACE],props)) {
    if (cbh == null) {
      throw new SaslException("CallbackHandler with support for AuthorizeCallback required");
    }
    return new ClearspaceSaslServer();
  }
  return null;
}
