{
  if (LockOutManager.getInstance().isAccountDisabled(username)) {
    LockOutManager.getInstance().recordFailedLogin(username);
    throw new UnauthorizedException();
  }
  authProvider.authenticate(username,token,digest);
  return new AuthToken(username);
}
