{
  Collection<Update> toDelete=new ArrayList<Update>();
  PluginManager pluginManager=XMPPServer.getInstance().getPluginManager();
  for (  Update update : toUpdate) {
    String latestVersion=update.getLatestVersion();
    if (update.isServer()) {
      String serverVersion=XMPPServer.getInstance().getServerInfo().getVersion().getVersionString();
      if (serverVersion.compareTo(latestVersion) >= 0) {
        toDelete.add(update);
      }
    }
 else {
      String pluginName=update.getURL().substring(update.getURL().lastIndexOf("/") + 1);
      Plugin plugin=pluginManager.getPlugin(pluginName.substring(0,pluginName.length() - 4).toLowerCase());
      if (plugin != null && pluginManager.getVersion(plugin).compareTo(latestVersion) >= 0) {
        toDelete.add(update);
      }
    }
  }
  if (!toDelete.isEmpty()) {
    toUpdate.removeAll(toDelete);
    saveResponse();
  }
}
