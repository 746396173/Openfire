{
  if (serverName.equals(recipient.getDomain()) && recipient.getResource() != null && userManager.isRegisteredUser(recipient.getNode())) {
    routingTable.routePacket(recipient.asBareJID(),packet,false);
  }
 else {
    messageStrategy.storeOffline((Message)packet);
  }
}
