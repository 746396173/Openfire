{
  if (session.getAuthToken().isAnonymous()) {
    routingTable.addClientRoute(session.getAddress(),session);
  }
 else {
    routingTable.addClientRoute(session.getAddress(),session);
    broadcastPresenceOfOtherResource(session);
    Presence selfPresence=presence.createCopy();
    selfPresence.setTo(session.getAddress());
    routingTable.routePacket(session.getAddress(),selfPresence,false);
  }
}
