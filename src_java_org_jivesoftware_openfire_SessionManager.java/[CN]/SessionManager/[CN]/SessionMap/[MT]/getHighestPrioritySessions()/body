{
  if (priorityList.isEmpty()) {
    return Collections.emptyList();
  }
  List<ClientSession> answer=new ArrayList<ClientSession>();
  int highest=-1;
synchronized (priorityList) {
    for (    String resource : priorityList) {
      ClientSession s=resources.get(resource);
      if (s != null && s.getPresence().isAvailable()) {
        if (s.getPresence().getPriority() >= 0 && s.getPresence().getPriority() >= highest) {
          highest=s.getPresence().getPriority();
          answer.add(s);
        }
      }
    }
  }
  return answer;
}
