{
  try {
    locateMessenger();
    if ("true".equals(JiveGlobals.getXMLProperty("setup"))) {
      setupMode=false;
    }
    if (isStandAlone()) {
      Runtime.getRuntime().addShutdownHook(new ShutdownHookThread());
    }
    lookup=new ServiceLookupImpl();
    ServiceItem serverItem=new ServiceItem(null,this,null);
    containerRegistration=lookup.register(serverItem);
    loader=Thread.currentThread().getContextClassLoader();
    if (setupMode) {
      loadCoreModules(getSetupModuleNames());
    }
 else {
      verifyDataSource();
      loadCoreModules(getBootModuleNames());
      loadCoreModules(getCoreModuleNames());
      loadCoreModules(getStandardModuleNames());
    }
    startCoreModules();
    File pluginDir=new File(messengerHome + "/plugins");
    pluginManager=new PluginManager(pluginDir,this);
    pluginManager.start();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Log.error(e);
    System.out.println(LocaleUtils.getLocalizedString("startup.error"));
    shutdownContainer();
  }
}
