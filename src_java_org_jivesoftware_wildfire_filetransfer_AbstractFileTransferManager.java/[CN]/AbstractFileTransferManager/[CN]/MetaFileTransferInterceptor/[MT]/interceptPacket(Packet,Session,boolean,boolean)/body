{
  if (!processed && incoming && packet instanceof IQ) {
    IQ iq=(IQ)packet;
    Element childElement=iq.getChildElement();
    if (childElement == null) {
      return;
    }
    String namespace=childElement.getNamespaceURI();
    if (!isFileTransferEnabled() && FILETRANSFER_NAMESPACES.contains(namespace)) {
      throw new PacketRejectedException("File Transfer Disabled");
    }
    if (NAMESPACE_SI.equals(namespace)) {
      if (iq.getType().equals(IQ.Type.set)) {
        JID from=iq.getFrom();
        JID to=iq.getTo();
        String packetID=iq.getID();
        if (!acceptIncomingFileTransferRequest(packetID,from,to,childElement)) {
          throw new PacketRejectedException();
        }
      }
    }
  }
}
