{
  if (isClosed()) {
    deliverer.deliver(packet);
  }
 else {
    try {
      InterceptorManager.getInstance().invokeInterceptors(packet,session,false,false);
synchronized (writer) {
        try {
          xmlSerializer.write(packet.getElement());
          if (flashClient) {
            writer.write('\0');
          }
          xmlSerializer.flush();
        }
 catch (        IOException e) {
          Log.warn(e);
          close();
          deliverer.deliver(packet);
        }
      }
      InterceptorManager.getInstance().invokeInterceptors(packet,session,false,true);
      session.incrementServerPacketCount();
    }
 catch (    PacketRejectedException e) {
    }
  }
}
