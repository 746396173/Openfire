{
  if (isClosed()) {
    deliverer.deliver(packet);
  }
 else {
synchronized (writer) {
      try {
        xmlSerializer.write(packet.getElement());
        if (flashClient) {
          writer.write('\0');
        }
        xmlSerializer.flush();
      }
 catch (      IOException e) {
        Log.error("Problem sending the following packet: " + packet.toXML());
        Log.error(e);
      }
    }
    auditor.audit(packet,session);
    session.incrementServerPacketCount();
  }
}
