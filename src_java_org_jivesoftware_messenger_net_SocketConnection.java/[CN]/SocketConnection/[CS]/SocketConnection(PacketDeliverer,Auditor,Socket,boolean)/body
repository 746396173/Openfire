{
  if (socket == null) {
    throw new NullPointerException("Socket channel must be non-null");
  }
  this.secure=isSecure;
  this.auditor=auditor;
  sock=socket;
  writer=new BufferedWriter(new OutputStreamWriter(sock.getOutputStream(),charset));
  this.deliverer=deliverer;
  if (xmlFactory == null) {
    xmlFactory=XMLOutputFactory.newInstance();
  }
  xmlSerializer=xmlFactory.createXMLStreamWriter(writer);
}
