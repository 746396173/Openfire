{
  super(registration,jid,transport,priority);
  if (Email.parseStr(registration.getUsername()) == null) {
    Message m=new Message();
    m.setType(Message.Type.error);
    m.setTo(getJID());
    m.setFrom(getTransport().getJID());
    m.setBody("You are registered with the MSN transport with an illegal account name.\nThe account name should look like an email address.\nYou registered as:" + registration.getUsername());
    return;
  }
  Log.debug("Creating MSN session for " + registration.getUsername());
  msnMessenger=MsnMessengerFactory.createMsnMessenger(registration.getUsername(),registration.getPassword());
  ((BasicMessenger)msnMessenger).addSessionListener(new MsnSessionListener(this));
  msnMessenger.setSupportedProtocol(new MsnProtocol[]{MsnProtocol.MSNP11});
}
