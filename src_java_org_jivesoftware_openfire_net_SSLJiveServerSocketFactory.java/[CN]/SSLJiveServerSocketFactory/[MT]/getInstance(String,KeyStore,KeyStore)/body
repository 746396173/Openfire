{
  try {
    SSLContext sslcontext=SSLContext.getInstance(algorithm);
    SSLServerSocketFactory factory;
    KeyManagerFactory keyFactory=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    keyFactory.init(keystore,SSLConfig.getKeyPassword().toCharArray());
    TrustManagerFactory trustFactory=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    trustFactory.init(truststore);
    sslcontext.init(keyFactory.getKeyManagers(),trustFactory.getTrustManagers(),new java.security.SecureRandom());
    factory=sslcontext.getServerSocketFactory();
    return new SSLJiveServerSocketFactory(factory);
  }
 catch (  Exception e) {
    Log.error(e);
    throw new IOException(e.getMessage());
  }
}
