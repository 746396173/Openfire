{
  BasicUserInfo userInfo=null;
  DirContext ctx=null;
  try {
    String userDN=null;
    ctx=manager.getContext();
    SearchControls constraints=new SearchControls();
    constraints.setSearchScope(SearchControls.SUBTREE_SCOPE);
    constraints.setReturningAttributes(new String[]{"jiveUserID"});
    StringBuffer filter=new StringBuffer();
    filter.append("(").append("jiveUserID").append("=");
    filter.append(id).append(")");
    NamingEnumeration answer=ctx.search("",filter.toString(),constraints);
    if (answer == null || !answer.hasMoreElements()) {
      throw new UserNotFoundException("User not found: " + id);
    }
    userDN=((SearchResult)answer.next()).getName();
    String[] attributes=new String[]{"jiveUserID",manager.getUsernameField(),manager.getNameField(),manager.getEmailField(),"jiveNameVisible","jiveEmailVisible","jiveCDate","jiveMDate","jiveProps"};
    Attributes attrs=ctx.getAttributes(userDN,attributes);
    id=Long.parseLong((String)attrs.get("jiveUserID").get());
    String username=(String)attrs.get(manager.getUsernameField()).get();
    String name=null;
    String email=null;
    boolean nameVisible=false;
    boolean emailVisible=false;
    Date creationDate, modificationDate;
    Attribute nameField=attrs.get(manager.getNameField());
    if (nameField != null) {
      name=(String)nameField.get();
    }
    Attribute emailField=attrs.get(manager.getEmailField());
    if (emailField != null) {
      email=(String)emailField.get();
    }
    nameVisible=new Boolean((String)attrs.get("jiveNameVisible").get()).booleanValue();
    emailVisible=new Boolean((String)attrs.get("jiveEmailVisible").get()).booleanValue();
    creationDate=new Date(Long.parseLong((String)attrs.get("jiveCDate").get()));
    modificationDate=new Date(Long.parseLong((String)attrs.get("jiveMDate").get()));
    userInfo=new BasicUserInfo(id,name,email,nameVisible,emailVisible,creationDate,modificationDate);
  }
 catch (  Exception e) {
    throw new UserNotFoundException(e);
  }
 finally {
    try {
      ctx.close();
    }
 catch (    Exception e) {
    }
  }
  return userInfo;
}
