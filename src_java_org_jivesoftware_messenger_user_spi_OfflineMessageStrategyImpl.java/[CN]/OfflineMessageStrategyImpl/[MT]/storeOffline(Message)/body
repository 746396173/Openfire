{
  if (message != null) {
    Session senderSession=message.getOriginatingSession();
    XMPPAddress sender=senderSession.getAddress();
    if (sender == null || sender.getName() == null) {
    }
 else {
      if (type == Type.bounce) {
        bounce(message);
      }
 else       if (type == Type.store) {
        store(message);
      }
 else       if (type == Type.store_and_bounce) {
        if (underQuota(message)) {
          store(message);
        }
 else {
          bounce(message);
        }
      }
 else       if (type == Type.store_and_drop) {
        if (underQuota(message)) {
          store(message);
        }
      }
    }
  }
}
