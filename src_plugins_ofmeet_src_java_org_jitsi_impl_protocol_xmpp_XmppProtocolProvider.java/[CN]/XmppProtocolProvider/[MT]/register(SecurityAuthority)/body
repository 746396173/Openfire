{
  String serviceName=org.jivesoftware.smack.util.StringUtils.parseServer(getAccountID().getUserID());
  String serverAddressUserSetting=jabberAccountID.getServerAddress();
  int serverPort=getAccountID().getAccountPropertyInt(ProtocolProviderFactory.SERVER_PORT,5222);
  ConnectionConfiguration connConfig=new ConnectionConfiguration(serverAddressUserSetting,serverPort,serviceName);
  connection=new XMPPConnection(connConfig);
  try {
    connection.connect();
    if (jabberAccountID.isAnonymousAuthUsed()) {
      connection.loginAnonymously();
    }
 else {
      String login=jabberAccountID.getAuthorizationName();
      String pass=jabberAccountID.getPassword();
      String resource=jabberAccountID.getResource();
      connection.login(login,pass,resource);
    }
  }
 catch (  XMPPException e) {
    throw new OperationFailedException("Failed to connect",OperationFailedException.GENERAL_ERROR,e);
  }
  colibriTools.initialize(getConnectionAdapter());
  jingleOpSet.initialize();
  discoInfoManager=new ScServiceDiscoveryManager(this,connection,new String[]{},new String[]{},false);
  registrationState=RegistrationState.REGISTERED;
  fireRegistrationStateChanged(RegistrationState.UNREGISTERED,RegistrationState.REGISTERED,RegistrationStateChangeEvent.REASON_NOT_SPECIFIED,null);
  logger.info("XMPP provider " + jabberAccountID + " connected (JID: "+ connection.getUser()+ ")");
}
