{
  String username=sender.getNode().toLowerCase();
  sessionLock.writeLock().lock();
  try {
    SessionMap resources=(SessionMap)sessions.get(username);
    if (resources == null) {
      return;
    }
    resources.changePriority(sender,priority);
    Session defaultSession=resources.getDefaultSession();
    routingTable.addRoute(new JID(defaultSession.getAddress().getNode(),defaultSession.getAddress().getDomain(),""),defaultSession);
  }
  finally {
    sessionLock.writeLock().unlock();
  }
}
