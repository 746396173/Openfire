{
  Presence presence=null;
  SessionMap sessionMap=sessions.get(session.getUsername());
  if (sessionMap != null) {
    for (    Session userSession : sessionMap.getAvailableSessions()) {
      if (userSession != session) {
        if (session.getPresence().isAvailable()) {
          presence=userSession.getPresence().createCopy();
          presence.setTo(session.getAddress());
          session.getConnection().deliver(presence);
        }
        presence=session.getPresence().createCopy();
        presence.setTo(userSession.getAddress());
        userSession.getConnection().deliver(presence);
      }
    }
  }
}
