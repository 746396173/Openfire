{
  sessionLock.readLock().lock();
  try {
    Iterator values=sessions.values().iterator();
    while (values.hasNext()) {
      ((SessionMap)values.next()).broadcast(packet);
    }
  }
  finally {
    sessionLock.readLock().unlock();
  }
  anonymousSessionLock.readLock().lock();
  try {
    for (    Session session : anonymousSessions.values()) {
      session.getConnection().deliver(packet);
    }
  }
  finally {
    anonymousSessionLock.readLock().unlock();
  }
}
