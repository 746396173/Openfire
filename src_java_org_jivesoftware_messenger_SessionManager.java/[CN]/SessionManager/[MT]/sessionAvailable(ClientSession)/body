{
  if (anonymousSessions.containsValue(session)) {
    routingTable.addRoute(session.getAddress(),session);
  }
 else {
    Session defaultSession=null;
    try {
      defaultSession=sessions.get(session.getUsername()).getDefaultSession(true);
      JID node=new JID(defaultSession.getAddress().getNode(),defaultSession.getAddress().getDomain(),null);
      routingTable.addRoute(node,defaultSession);
      routingTable.addRoute(session.getAddress(),session);
      broadcastPresenceToOtherResource(session);
    }
 catch (    UserNotFoundException e) {
    }
catch (    UnauthorizedException e) {
    }
  }
}
