{
  if (username == null || password == null) {
    throw new UnauthorizedException();
  }
  username=username.trim().toLowerCase();
  String userPassword=getPassword(username);
  if (passwordType == PasswordType.md5) {
    password=StringUtils.hash(password,"MD5");
  }
 else   if (passwordType == PasswordType.sha1) {
    password=StringUtils.hash(password,"SHA-1");
  }
  if (!password.equals(userPassword)) {
    throw new UnauthorizedException();
  }
  createUser(username);
}
