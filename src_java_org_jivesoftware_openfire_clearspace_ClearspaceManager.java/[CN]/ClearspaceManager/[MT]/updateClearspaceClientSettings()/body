{
  String xmppBoshSslPort="0";
  String xmppBoshPort="0";
  String xmppPort=String.valueOf(XMPPServer.getInstance().getConnectionManager().getClientListenerPort());
  if (JiveGlobals.getBooleanProperty(HttpBindManager.HTTP_BIND_ENABLED,HttpBindManager.HTTP_BIND_ENABLED_DEFAULT)) {
    int boshSslPort=HttpBindManager.getInstance().getHttpBindSecurePort();
    int boshPort=HttpBindManager.getInstance().getHttpBindUnsecurePort();
    try {
      if (CertificateManager.isRSACertificate(SSLConfig.getKeyStore(),XMPPServer.getInstance().getServerInfo().getXMPPDomain()) && LocalClientSession.getTLSPolicy() != org.jivesoftware.openfire.Connection.TLSPolicy.disabled && boshSslPort > 0) {
        xmppBoshSslPort=String.valueOf(boshSslPort);
      }
    }
 catch (    Exception e) {
      Log.debug("Error while checking SSL certificate.  Instructing Clearspace not to use SSL port.");
    }
    if (boshPort > 0) {
      xmppBoshPort=String.valueOf(boshPort);
    }
  }
  try {
    String path=CHAT_URL_PREFIX + "updateClientSettings/";
    Document groupDoc=DocumentHelper.createDocument();
    Element rootE=groupDoc.addElement("updateClientSettings");
    rootE.addElement("boshSslPort").setText(xmppBoshSslPort);
    rootE.addElement("boshPort").setText(xmppBoshPort);
    rootE.addElement("tcpPort").setText(xmppPort);
    executeRequest(POST,path,groupDoc.asXML());
  }
 catch (  UnauthorizedException ue) {
    Log.error("Error updating the client settings of Clearspace",ue);
  }
catch (  Exception e) {
    Log.error("Error updating the client settings of Clearspace",e);
  }
}
