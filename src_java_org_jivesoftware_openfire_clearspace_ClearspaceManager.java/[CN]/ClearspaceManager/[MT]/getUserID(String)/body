{
  if (username.contains("@")) {
    if (!XMPPServer.getInstance().isLocal(new JID(username))) {
      throw new UserNotFoundException("Cannot load user of remote server: " + username);
    }
    username=username.substring(0,username.lastIndexOf("@"));
  }
  if (userIDCache.containsKey(username)) {
    return userIDCache.get(username);
  }
  String unescapedUsername=JID.unescapeNode(username);
  try {
    unescapedUsername=URLEncoder.encode(unescapedUsername,"UTF-8");
    String path=ClearspaceUserProvider.USER_URL_PREFIX + "users/" + unescapedUsername;
    Element element=executeRequest(org.jivesoftware.openfire.clearspace.ClearspaceManager.HttpType.GET,path);
    Long id=Long.valueOf(WSUtils.getElementText(element.selectSingleNode("return"),"ID"));
    userIDCache.put(username,id);
    return id;
  }
 catch (  UserNotFoundException unfe) {
    throw unfe;
  }
catch (  Exception e) {
    throw new UserNotFoundException("Unexpected error",e);
  }
}
