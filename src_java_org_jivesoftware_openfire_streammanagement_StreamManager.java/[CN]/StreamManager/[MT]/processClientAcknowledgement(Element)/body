{
  if (isEnabled()) {
synchronized (this) {
      if (ack.attribute("h") != null) {
        long count=Long.valueOf(ack.attributeValue("h"));
        Log.debug("Ack: h={} mine={} length={}",count,clientProcessedStanzas,unacknowledgedServerStanzas.size());
        if (count < clientProcessedStanzas) {
          Log.debug("Maybe rollover");
          if (clientProcessedStanzas > mask) {
            while (count < clientProcessedStanzas) {
              Log.debug("Rolling...");
              count+=mask + 1;
            }
          }
        }
        while (clientProcessedStanzas < count) {
          unacknowledgedServerStanzas.removeFirst();
          clientProcessedStanzas++;
          Log.debug("In Ack: h={} mine={} length={}",count,clientProcessedStanzas,unacknowledgedServerStanzas.size());
        }
        if (count >= clientProcessedStanzas) {
          clientProcessedStanzas=count;
        }
      }
    }
  }
}
