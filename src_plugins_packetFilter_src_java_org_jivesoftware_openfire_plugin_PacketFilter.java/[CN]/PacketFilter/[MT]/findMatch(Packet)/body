{
  if (packet.getTo() == null || packet.getFrom() == null)   return null;
  String to=packet.getTo().toBareJID();
  String from=packet.getFrom().toBareJID();
  for (  Rule rule : ruleManager.getRules()) {
    if (!rule.isDisabled() && typeMatch(rule.getPackeType().toString(),packet) && sourceDestMatch(rule.getDestType(),rule.getDestination(),to)&& sourceDestMatch(rule.getSourceType(),rule.getSource(),from)) {
      return rule;
    }
  }
  return null;
}
