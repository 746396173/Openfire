{
  for (  String subprotocol : req.getSubProtocols()) {
    XMPPWebSocket socket=new XMPPWebSocket();
    if (doWebSocketConnect(req.getHttpServletRequest(),socket)) {
      resp.setAcceptedSubProtocol(subprotocol);
      return socket;
    }
 else     return null;
  }
  return null;
}
