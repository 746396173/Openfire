{
  if (!isActivatable()) {
    throw new IOException("Transfer missing party");
  }
  InputStream in=getInitiatorSocket().getInputStream();
  OutputStream out=new ProxyOutputStream(getTargetSocket().getOutputStream());
  final byte[] b=new byte[BUFFER_SIZE];
  int count=0;
  amountWritten=0;
  do {
    out.write(b,0,count);
    amountWritten+=count;
    count=in.read(b);
  }
 while (count >= 0);
  getInitiatorSocket().close();
  getTargetSocket().close();
}
