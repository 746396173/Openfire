{
  JID targetJID=new JID(jid);
  if (targetJID.getDomain() == null || XMPPServer.getInstance().isRemote(targetJID)) {
    throw new UserNotFoundException("Domain does not matches local server domain");
  }
  if (!hostname.equals(targetJID.getDomain())) {
    throw new UserNotFoundException("Presence of components not supported yet!");
  }
  if (targetJID.getNode() == null) {
    throw new UserNotFoundException("Username is null");
  }
  if (!isPresencePublic()) {
    if (sender == null) {
      throw new UserNotFoundException("Sender is null");
    }
 else     if (!presenceManager.canProbePresence(new JID(sender),targetJID.getNode())) {
      throw new UserNotFoundException("Sender is not allowed to probe this user");
    }
  }
  User user=userManager.getUser(targetJID.getNode());
  return presenceManager.getPresence(user);
}
