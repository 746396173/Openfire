{
  getRegistration().setLastLogin(new Date());
  List<TransportBuddy> legacyusers=new ArrayList<TransportBuddy>();
  for (  BuddyItem buddy : buddies.values()) {
    String nickname=buddy.getAlias();
    if (nickname == null) {
      nickname=buddy.getScreenname();
    }
    int groupid=buddy.getGroupId();
    String groupname="Transport Buddies";
    if (groups.containsKey(groupid)) {
      groupname=groups.get(groupid).getGroupName();
      if (groupname.length() < 1) {
        groupname="Transport Buddies";
      }
    }
    legacyusers.add(new TransportBuddy(buddy.getScreenname(),nickname,groupname));
  }
  try {
    getTransport().syncLegacyRoster(getJID(),legacyusers);
  }
 catch (  UserNotFoundException e) {
    Log.error("Unable to sync oscar contact list for " + getJID(),e);
  }
  updateStatus(this.presenceType,this.verboseStatus);
}
