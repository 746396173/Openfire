{
  if (presenceType != PresenceType.available && presenceType != PresenceType.chat) {
    String awayMsg="Away";
    if (verboseStatus != null) {
      awayMsg=verboseStatus;
    }
    request(new SetInfoCmd(new InfoData(awayMsg,null,MY_CAPS,null)));
    if (getTransport().getLegacyMode()) {
      Presence p=new Presence();
      p.setShow(Presence.Show.away);
      p.setTo(getJID());
      p.setFrom(getTransport().getJID());
      getTransport().sendPacket(p);
    }
  }
 else {
    request(new SetInfoCmd(new InfoData(InfoData.NOT_AWAY,null,MY_CAPS,null)));
    if (getTransport().getLegacyMode()) {
      Presence p=new Presence();
      p.setTo(getJID());
      p.setFrom(getTransport().getJID());
      getTransport().sendPacket(p);
    }
  }
  this.presenceType=presenceType;
  this.verboseStatus=verboseStatus;
}
