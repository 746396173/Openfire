{
  ArrayList identities=new ArrayList();
  if (name == null && node == null) {
    Element identity=DocumentHelper.createElement("identity");
    identity.addAttribute("category","conference");
    identity.addAttribute("name","Public Chatrooms");
    identity.addAttribute("type","text");
    identities.add(identity);
  }
 else   if (name != null && node == null) {
    MUCRoom room=getChatRoom(name);
    if (room != null && room.isPublicRoom()) {
      Element identity=DocumentHelper.createElement("identity");
      identity.addAttribute("category","conference");
      identity.addAttribute("name",room.getName());
      identity.addAttribute("type","text");
      identities.add(identity);
    }
  }
 else   if (name != null && "x-roomuser-item".equals(node)) {
    MUCRoom room=getChatRoom(name);
    if (room != null) {
      String reservedNick=room.getReservedNickname(senderJID.toBareStringPrep());
      if (reservedNick != null) {
        Element identity=DocumentHelper.createElement("identity");
        identity.addAttribute("category","conference");
        identity.addAttribute("name",reservedNick);
        identity.addAttribute("type","text");
        identities.add(identity);
      }
    }
  }
  return identities.iterator();
}
