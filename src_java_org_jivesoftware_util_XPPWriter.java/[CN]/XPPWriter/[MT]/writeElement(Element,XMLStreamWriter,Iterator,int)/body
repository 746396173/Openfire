{
  int size=element.nodeCount();
  String namespace=element.getNamespace().getURI();
  NamespaceContext context=serializer.getNamespaceContext();
  if (namespace == null || "".equals(namespace)) {
    serializer.writeStartElement(element.getName());
  }
 else {
    String prefix=context.getPrefix(namespace);
    if (prefix == null) {
      serializer.writeStartElement(element.getName());
      serializer.writeDefaultNamespace(namespace);
    }
 else     if (prefix.equals(XMLConstants.DEFAULT_NS_PREFIX)) {
      serializer.writeStartElement(element.getName());
    }
 else {
      serializer.writeStartElement(prefix,element.getName());
    }
  }
  writeAttributes(element,serializer);
  if (size > 0) {
    writeElementContent(element,serializer);
  }
  if (fragments != null) {
    while (fragments.hasNext()) {
      ((XMPPFragment)fragments.next()).send(serializer,version);
    }
  }
  serializer.writeEndElement();
}
