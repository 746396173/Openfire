{
  Presence oldPresence=this.presence;
  this.presence=presence;
  if (oldPresence.isAvailable() && !this.presence.isAvailable()) {
    sessionManager.sessionUnavailable(this);
    setInitialized(false);
  }
 else   if (!oldPresence.isAvailable() && this.presence.isAvailable()) {
    sessionManager.sessionAvailable(this);
    wasAvailable=true;
  }
 else   if (this.presence.isAvailable() && oldPresence.getPriority() != this.presence.getPriority()) {
    sessionManager.changePriority(getAddress(),this.presence.getPriority());
  }
  return oldPresence;
}
