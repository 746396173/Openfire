{
  if (!isLoggedIn()) {
    new Thread(){
      public void run(){
        try {
          conn=new XMPPConnection(config);
          conn.connect();
          conn.addConnectionListener(listener);
          conn.login(acctjid.getNode(),getRegistration().getPassword(),"IMGateway");
          conn.getRoster().addRosterListener(listener);
          conn.getChatManager().addChatListener(listener);
          setLoginStatus(TransportLoginStatus.LOGGED_IN);
          Presence p=new Presence();
          p.setTo(getJIDWithHighestPriority());
          p.setFrom(getTransport().getJID());
          getTransport().sendPacket(p);
          getRegistration().setLastLogin(new Date());
        }
 catch (        XMPPException e) {
          Log.error(getTransport().getType() + " user is not able to log in: " + getRegistration().getUsername(),e);
        }
      }
    }
.start();
  }
}
