{
  RawPacket[] pkts=rawPacketArrayPool.poll();
  if (pkts == null)   pkts=new RawPacket[1];
  RawPacket pkt=rawPacketPool.poll();
  if (pkt == null)   pkt=new RawPacket();
  byte[] buffer=pkt.getBuffer();
  int length=datagramPacket.getLength();
  if (buffer == null || buffer.length < length) {
    buffer=new byte[length];
    pkt.setBuffer(buffer);
  }
  System.arraycopy(datagramPacket.getData(),datagramPacket.getOffset(),buffer,0,length);
  pkt.setBuffer(buffer);
  pkt.setOffset(0);
  pkt.setLength(length);
  pkt.setFlags(0);
  pkts[0]=pkt;
  return pkts;
}
