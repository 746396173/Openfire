{
  Element headers=null;
  if (subIDs != null) {
    headers=notification.addChildElement("headers","http://jabber.org/protocol/shim");
    for (    String subID : subIDs) {
      Element header=headers.addElement("header");
      header.addAttribute("name","pubsub#subid");
      header.setText(subID);
    }
  }
  String username=subscriberJID.getNode();
  String resource=subscriberJID.getResource();
  if (resource == null || SessionManager.getInstance().isActiveRoute(username,resource)) {
    service.sendNotification(this,notification,subscriberJID);
  }
  if (headers != null) {
    notification.getElement().remove(headers);
  }
}
