{
  XMPPPacketReader reader;
  Writer writer=null;
  socket.setSoTimeout(RemoteServerManager.getSocketTimeout());
  VerifyResult result=VerifyResult.error;
  try {
    reader=new XMPPPacketReader();
    reader.setXPPFactory(FACTORY);
    reader.getXPPParser().setInput(new InputStreamReader(socket.getInputStream(),CHARSET));
    writer=new BufferedWriter(new OutputStreamWriter(socket.getOutputStream(),CHARSET));
    result=sendVerifyKey(key,streamID,recipient,hostname,writer,reader,socket);
  }
  finally {
    try {
      Log.debug("ServerDialback: RS - Closing connection to Authoritative Server: " + hostname);
      StringBuilder sb=new StringBuilder();
      sb.append("</stream:stream>");
      writer.write(sb.toString());
      writer.flush();
      socket.close();
    }
 catch (    IOException ioe) {
    }
  }
  return result;
}
