{
  if (connection.getTlsPolicy() == SocketConnection.TLSPolicy.required && !connection.isSecure()) {
    closeNeverSecuredConnection();
    return false;
  }
  SASLAuthentication saslAuth=new SASLAuthentication(session,reader);
  return saslAuth.doHandshake(doc);
}
