{
  if (isClientSSLListenerEnabled()) {
    int port=getClientSSLListenerPort();
    String algorithm=JiveGlobals.getProperty("xmpp.socket.ssl.algorithm","TLS");
    try {
      int eventThreads=JiveGlobals.getIntProperty("xmpp.client_ssl.processing.threads",16);
      ExecutorFilter executorFilter=new ExecutorFilter(eventThreads + 1,eventThreads + 1,60,TimeUnit.SECONDS);
      ThreadPoolExecutor eventExecutor=(ThreadPoolExecutor)executorFilter.getExecutor();
      final ThreadFactory originalThreadFactory=eventExecutor.getThreadFactory();
      ThreadFactory newThreadFactory=new ThreadFactory(){
        private final AtomicInteger threadId=new AtomicInteger(0);
        public Thread newThread(        Runnable runnable){
          Thread t=originalThreadFactory.newThread(runnable);
          t.setName("Old SSL executor thread - " + threadId.incrementAndGet());
          t.setDaemon(true);
          return t;
        }
      }
;
      eventExecutor.setThreadFactory(newThreadFactory);
      sslSocketAcceptor=buildSocketAcceptor(CLIENT_SSL_SOCKET_ACCEPTOR_NAME);
      sslSocketAcceptor.getFilterChain().addFirst(EXECUTOR_FILTER_NAME,executorFilter);
      sslSocketAcceptor.getFilterChain().addAfter(EXECUTOR_FILTER_NAME,XMPP_CODEC_FILTER_NAME,new ProtocolCodecFilter(new XMPPCodecFactory()));
      sslSocketAcceptor.getFilterChain().addAfter(XMPP_CODEC_FILTER_NAME,CAPACITY_FILTER_NAME,new StalledSessionsFilter());
      SSLContext sslContext=SSLContext.getInstance(algorithm);
      KeyManagerFactory keyFactory=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
      keyFactory.init(SSLConfig.getKeyStore(),SSLConfig.getKeyPassword().toCharArray());
      TrustManagerFactory trustFactory=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
      trustFactory.init(SSLConfig.getc2sTrustStore());
      sslContext.init(keyFactory.getKeyManagers(),trustFactory.getTrustManagers(),new java.security.SecureRandom());
      SslFilter sslFilter=new SslFilter(sslContext);
      if (JiveGlobals.getProperty("xmpp.client.cert.policy","disabled").equals("needed")) {
        sslFilter.setNeedClientAuth(true);
      }
 else       if (JiveGlobals.getProperty("xmpp.client.cert.policy","disabled").equals("wanted")) {
        sslFilter.setWantClientAuth(true);
      }
      sslSocketAcceptor.getFilterChain().addFirst(TLS_FILTER_NAME,sslFilter);
    }
 catch (    Exception e) {
      System.err.println("Error starting SSL XMPP listener on port " + port + ": "+ e.getMessage());
      Log.error(LocaleUtils.getLocalizedString("admin.error.ssl"),e);
    }
  }
}
