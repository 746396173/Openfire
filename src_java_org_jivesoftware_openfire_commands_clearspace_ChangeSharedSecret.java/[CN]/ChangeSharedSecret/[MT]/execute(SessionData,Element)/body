{
  Element note=command.addElement("note");
  Map<String,List<String>> data=sessionData.getData();
  String oldSharedSecret=get(data,"oldSharedSecret",0);
  if (oldSharedSecret == null || "".equals(oldSharedSecret)) {
    note.addAttribute("type","error");
    note.setText("Old shared secret is empty or do not match.");
    return;
  }
  String newSharedSecret=get(data,"newSharedSecret",0);
  if (newSharedSecret == null || "".equals(newSharedSecret)) {
    note.addAttribute("type","error");
    note.setText("New shared secret is empty or do not match.");
    return;
  }
  ClearspaceManager manager=ClearspaceManager.getInstance();
  if (!manager.getSharedSecret().equals(oldSharedSecret)) {
    note.addAttribute("type","error");
    note.setText("Old shared secret is not valid.");
    return;
  }
  ClearspaceManager.getInstance().setSharedSecret(newSharedSecret);
  note.addAttribute("type","info");
  note.setText("Operation finished successfully");
}
