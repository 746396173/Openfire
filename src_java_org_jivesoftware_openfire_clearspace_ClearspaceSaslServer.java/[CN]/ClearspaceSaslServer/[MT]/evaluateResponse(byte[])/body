{
  ClearspaceManager csManager=ClearspaceManager.getInstance();
  String responseStr=new String(response);
  StringTokenizer tokens=new StringTokenizer(responseStr,"\u0000");
  if (tokens.countTokens() != 2) {
    completed=false;
    return null;
  }
  jid=tokens.nextToken();
  int atIndex=jid.lastIndexOf("@");
  String node=jid.substring(0,atIndex);
  jid=JID.escapeNode(node) + "@" + jid.substring(atIndex + 1);
  try {
    responseStr=StringUtils.encodeBase64(responseStr);
    Element resultElement=csManager.executeRequest(GET,"groupChatAuthService/isAuthTokenValid/" + responseStr);
    if ("true".equals(WSUtils.getReturn(resultElement))) {
      completed=true;
    }
 else {
      throw new SaslException("SASL CLEARSPACE: user not authorized: " + jid);
    }
  }
 catch (  SaslException e) {
    throw e;
  }
catch (  Exception e) {
    Log.error("Failed communicating with Clearspace",e);
    throw new SaslException("SASL CLEARSPACE: user not authorized due to an error: " + jid);
  }
  return null;
}
