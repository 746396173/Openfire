def QuoteShellArgument(arg, flavor):
    'Quote a string such that it will be interpreted as a single argument\n  by the shell.'
    if re.match('^[a-zA-Z0-9_=.\\\\/-]+$', arg):
        return arg
    if (flavor == 'win'):
        return gyp.msvs_emulation.QuoteForRspFile(arg)
    return (("'" + arg.replace("'", (("'" + '"\'"') + "'"))) + "'")
