{
  isTrying=false;
  log.debug("Spun up new session to {}",domain.toString());
  int sent=0;
  this.session=session;
  while (this.packets != null && !this.packets.isEmpty()) {
    Packet packet=this.packets.remove();
    this.session.process(packet);
    sent=sent + 1;
  }
  this.packets=null;
  log.debug("Done, sent {} pending stanzas.",sent);
}
