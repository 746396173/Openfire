{
  if (node.isAdmin(subscriber)) {
    return true;
  }
  for (  JID nodeOwner : node.getOwners()) {
    if (nodeOwner.equals(subscriber)) {
      return true;
    }
  }
  XMPPServer server=XMPPServer.getInstance();
  if (server.isLocal(subscriber)) {
    Collection<String> nodeGroups=node.getRosterGroupsAllowed();
    for (    Group group : server.getRosterManager().getSharedGroups(subscriber.getNode())) {
      if (nodeGroups.contains(group.getName())) {
        if (Log.isDebugEnabled()) {
          Log.debug("Subscriber (" + subscriber + ") is a member of node group "+ group.getName());
        }
        return true;
      }
    }
  }
 else {
    Log.warn("Node with access model Roster has a remote user as subscriber: " + node.getNodeID());
  }
  return false;
}
