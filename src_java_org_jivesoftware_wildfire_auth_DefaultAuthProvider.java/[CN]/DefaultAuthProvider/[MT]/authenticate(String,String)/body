{
  if (username == null || password == null) {
    throw new UnauthorizedException();
  }
  username=username.trim().toLowerCase();
  try {
    if (!password.equals(userProvider.getPassword(username))) {
      throw new UnauthorizedException();
    }
  }
 catch (  UserNotFoundException unfe) {
    throw new UnauthorizedException();
  }
}
