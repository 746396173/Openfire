{
  if (key == null || value == null) {
    throw new NullPointerException();
  }
  Map<String,Object> eventParams=new HashMap<String,Object>();
  Object answer;
  String keyString=(String)key;
synchronized (keyString.intern()) {
    if (properties.containsKey(keyString)) {
      String originalValue=properties.get(keyString);
      if (originalValue != null && originalValue.equals(value)) {
        return value;
      }
      answer=properties.put(keyString,(String)value);
      updateProperty(keyString,(String)value);
      eventParams.put("type","propertyModified");
      eventParams.put("propertyKey",key);
      eventParams.put("originalValue",originalValue);
    }
 else {
      answer=properties.put(keyString,(String)value);
      insertProperty(keyString,(String)value);
      eventParams.put("type","propertyAdded");
      eventParams.put("propertyKey",key);
    }
  }
  GroupEventDispatcher.dispatchEvent(Group.this,GroupEventDispatcher.EventType.group_modified,eventParams);
  return answer;
}
