{
  if (!(session instanceof ClientSession) && !(session instanceof IncomingServerSession)) {
    return "";
  }
  StringBuilder sb=new StringBuilder(195);
  sb.append("<mechanisms xmlns=\"urn:ietf:params:xml:ns:xmpp-sasl\">");
  if (session instanceof IncomingServerSession) {
    if (session.getConnection().isSecure()) {
      sb.append("<mechanism>EXTERNAL</mechanism>");
    }
  }
 else {
    for (    String mech : getSupportedMechanisms()) {
      sb.append("<mechanism>");
      sb.append(mech);
      sb.append("</mechanism>");
    }
  }
  sb.append("</mechanisms>");
  return sb.toString();
}
