def _GetMsbuildToolsetOfProject(proj_path, spec, version):
    'Get the platform toolset for the project.\n\n  Arguments:\n    proj_path: Path of the vcproj or vcxproj file to generate.\n    spec: The target dictionary containing the properties of the target.\n    version: The MSVSVersion object.\n  Returns:\n    the platform toolset string or None.\n  '
    default_config = _GetDefaultConfiguration(spec)
    toolset = default_config.get('msbuild_toolset')
    if ((not toolset) and version.DefaultToolset()):
        toolset = version.DefaultToolset()
    return toolset
