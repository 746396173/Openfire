def _EscapeCppDefineForMSBuild(s):
    'Escapes a CPP define so that it will reach the compiler unaltered.'
    s = _EscapeEnvironmentVariableExpansion(s)
    s = _EscapeCommandLineArgumentForMSBuild(s)
    s = _EscapeMSBuildSpecialCharacters(s)
    s = s.replace('#', ('\\%03o' % ord('#')))
    return s
