def _GetMSBuildPropertySheets(configurations):
    user_props = '$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props'
    additional_props = {}
    props_specified = False
    for (name, settings) in sorted(configurations.iteritems()):
        configuration = _GetConfigurationCondition(name, settings)
        if settings.has_key('msbuild_props'):
            additional_props[configuration] = _FixPaths(settings['msbuild_props'])
            props_specified = True
        else:
            additional_props[configuration] = ''
    if (not props_specified):
        return [['ImportGroup', {'Label': 'PropertySheets', }, ['Import', {'Project': user_props, 'Condition': ("exists('%s')" % user_props), 'Label': 'LocalAppDataPlatform', }]]]
    else:
        sheets = []
        for (condition, props) in additional_props.iteritems():
            import_group = ['ImportGroup', {'Label': 'PropertySheets', 'Condition': condition, }, ['Import', {'Project': user_props, 'Condition': ("exists('%s')" % user_props), 'Label': 'LocalAppDataPlatform', }]]
            for props_file in props:
                import_group.append(['Import', {'Project': props_file, }])
            sheets.append(import_group)
        return sheets
