{
  IQ replyPacket=null;
  Element dataElement=packet.getChildElement();
  if (dataElement != null) {
    if (IQ.Type.get.equals(packet.getType())) {
      replyPacket=IQ.createResultIQ(packet);
      Element dataStored=privateStorage.get(packet.getFrom().getNode(),dataElement);
      dataStored.setParent(null);
      replyPacket.setChildElement(dataStored);
    }
 else {
      privateStorage.add(packet.getFrom().getNode(),dataElement);
      replyPacket=IQ.createResultIQ(packet);
    }
  }
 else {
    replyPacket=IQ.createResultIQ(packet);
    replyPacket.setChildElement("query","jabber:iq:private");
  }
  return replyPacket;
}
