{
  int oldAffiliation=MUCRole.NONE;
  if (MUCRole.OWNER != sendRole.getAffiliation()) {
    throw new ForbiddenException();
  }
  if (owners.contains(bareJID) && owners.size() == 1) {
    throw new ConflictException();
  }
  admins.add(bareJID);
  if (removeOwner(bareJID)) {
    oldAffiliation=MUCRole.OWNER;
  }
 else   if (removeMember(bareJID)) {
    oldAffiliation=MUCRole.MEMBER;
  }
 else   if (removeOutcast(bareJID)) {
    oldAffiliation=MUCRole.OUTCAST;
  }
  MUCPersistenceManager.saveAffiliationToDB(this,bareJID,null,MUCRole.ADMINISTRATOR,oldAffiliation);
  try {
    return changeAffiliationOfOccupant(bareJID,MUCRole.ADMINISTRATOR,MUCRole.MODERATOR);
  }
 catch (  NotAllowedException e) {
    return null;
  }
}
