{
  MUCRole.Affiliation oldAffiliation=MUCRole.Affiliation.none;
  if (MUCRole.Affiliation.owner != sendRole.getAffiliation()) {
    throw new ForbiddenException();
  }
  if (owners.contains(bareJID) && owners.size() == 1) {
    throw new ConflictException();
  }
  admins.add(bareJID);
  if (removeOwner(bareJID)) {
    oldAffiliation=MUCRole.Affiliation.owner;
  }
 else   if (removeMember(bareJID)) {
    oldAffiliation=MUCRole.Affiliation.member;
  }
 else   if (removeOutcast(bareJID)) {
    oldAffiliation=MUCRole.Affiliation.outcast;
  }
  MUCPersistenceManager.saveAffiliationToDB(this,bareJID,null,MUCRole.Affiliation.admin,oldAffiliation);
  try {
    return changeOccupantAffiliation(bareJID,MUCRole.Affiliation.admin,MUCRole.Role.moderator);
  }
 catch (  NotAllowedException e) {
    return null;
  }
}
