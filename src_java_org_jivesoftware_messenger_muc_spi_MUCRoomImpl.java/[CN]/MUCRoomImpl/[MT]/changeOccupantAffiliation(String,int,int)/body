{
  List<Presence> presences=new ArrayList<Presence>();
  List<MUCRole> roles=occupantsByBareJID.get(bareJID);
  if (roles == null) {
    return presences;
  }
  for (  MUCRole role : roles) {
    role.setAffiliation(newAffiliation);
    role.setRole(newRole);
    Presence presence=role.getPresence().createCopy();
    presence.setFrom(role.getRoleAddress());
    presences.add(presence);
  }
  return presences;
}
