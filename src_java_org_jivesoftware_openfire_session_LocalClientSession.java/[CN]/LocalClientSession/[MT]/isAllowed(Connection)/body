{
  if (!allowedIPs.isEmpty()) {
    boolean forbidAccess=false;
    try {
      if (!allowedIPs.contains(connection.getHostAddress())) {
        forbidAccess=!isAddressInRange(connection.getAddress(),allowedIPs);
      }
    }
 catch (    UnknownHostException e) {
      forbidAccess=true;
    }
    return !forbidAccess;
  }
  return true;
}
