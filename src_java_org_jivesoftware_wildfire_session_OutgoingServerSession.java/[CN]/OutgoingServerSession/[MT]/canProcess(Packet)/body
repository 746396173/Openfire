{
  String senderDomain=packet.getFrom().getDomain();
  if (!getAuthenticatedDomains().contains(senderDomain)) {
synchronized (senderDomain.intern()) {
      if (!getAuthenticatedDomains().contains(senderDomain) && !authenticateSubdomain(senderDomain,packet.getTo().getDomain())) {
        returnErrorToSender(packet);
        return false;
      }
    }
  }
  return true;
}
