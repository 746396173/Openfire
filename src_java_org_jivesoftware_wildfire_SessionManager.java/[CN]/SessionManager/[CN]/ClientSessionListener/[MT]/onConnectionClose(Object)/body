{
  try {
    ClientSession session=(ClientSession)handback;
    try {
      if (session.getPresence().isAvailable() || !session.wasAvailable()) {
        Presence presence=new Presence();
        presence.setType(Presence.Type.unavailable);
        presence.setFrom(session.getAddress());
        presenceHandler.process(presence);
      }
    }
  finally {
      if (removeSession(session)) {
        usersSessionsCounter.decrementAndGet();
      }
    }
  }
 catch (  Exception e) {
    Log.error(LocaleUtils.getLocalizedString("admin.error.close"),e);
  }
}
