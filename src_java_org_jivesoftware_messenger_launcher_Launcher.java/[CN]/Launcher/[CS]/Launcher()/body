{
  final SystemTray tray=SystemTray.getDefaultSystemTray();
  try {
    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  String title="Jive Messenger";
  frame=new DroppableFrame(){
    public void fileDropped(    File file){
      String fileName=file.getName();
      if (fileName.endsWith("*.jar")) {
        installPlugin(file);
      }
    }
  }
;
  frame.setTitle(title);
  ImageIcon splash=null;
  JLabel splashLabel=null;
  try {
    splash=new ImageIcon(getClass().getClassLoader().getResource("splash.gif"));
    splashLabel=new JLabel("",splash,JLabel.LEFT);
    onIcon=new ImageIcon(getClass().getClassLoader().getResource("messenger_on-16x16.gif"));
    offIcon=new ImageIcon(getClass().getClassLoader().getResource("messenger_off-16x16.gif"));
    frame.setIconImage(offIcon.getImage());
  }
 catch (  Exception e) {
  }
  JPanel mainPanel=new JPanel();
  mainPanel.setLayout(new BorderLayout());
  final JButton startButton=new JButton("Start");
  startButton.setActionCommand("Start");
  final JButton stopButton=new JButton("Stop");
  stopButton.setActionCommand("Stop");
  final JButton browserButton=new JButton("Launch Admin");
  browserButton.setActionCommand("Launch Admin");
  final JButton quitButton=new JButton("Quit");
  quitButton.setActionCommand("Quit");
  toolbar.setLayout(new GridBagLayout());
  toolbar.add(startButton,new GridBagConstraints(0,0,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(5,5,5,5),0,0));
  toolbar.add(stopButton,new GridBagConstraints(1,0,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(5,5,5,5),0,0));
  toolbar.add(browserButton,new GridBagConstraints(2,0,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(5,5,5,5),0,0));
  toolbar.add(quitButton,new GridBagConstraints(3,0,1,1,0.0,0.0,GridBagConstraints.WEST,GridBagConstraints.NONE,new Insets(5,5,5,5),0,0));
  if (splashLabel != null) {
    mainPanel.add(splashLabel,BorderLayout.CENTER);
  }
  mainPanel.add(toolbar,BorderLayout.SOUTH);
  JPopupMenu menu=new JPopupMenu("Messenger Menu");
  final JMenuItem showMenuItem=new JMenuItem("Hide");
  showMenuItem.setActionCommand("Hide/Show");
  menu.add(showMenuItem);
  final JMenuItem startMenuItem=new JMenuItem("Start");
  startMenuItem.setActionCommand("Start");
  menu.add(startMenuItem);
  final JMenuItem stopMenuItem=new JMenuItem("Stop");
  stopMenuItem.setActionCommand("Stop");
  menu.add(stopMenuItem);
  final JMenuItem browserMenuItem=new JMenuItem("Launch Admin");
  browserMenuItem.setActionCommand("Launch Admin");
  menu.add(browserMenuItem);
  menu.addSeparator();
  final JMenuItem quitMenuItem=new JMenuItem("Quit");
  quitMenuItem.setActionCommand("Quit");
  menu.add(quitMenuItem);
  browserButton.setEnabled(false);
  stopButton.setEnabled(false);
  browserMenuItem.setEnabled(false);
  stopMenuItem.setEnabled(false);
  ActionListener actionListener=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      if ("Start".equals(e.getActionCommand())) {
        frame.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        startApplication();
        startButton.setEnabled(false);
        stopButton.setEnabled(true);
        startMenuItem.setEnabled(false);
        stopMenuItem.setEnabled(true);
        frame.setIconImage(onIcon.getImage());
        trayIcon.setIcon(onIcon);
        Thread thread=new Thread(){
          public void run(){
            try {
              sleep(8000);
            }
 catch (            Exception e) {
            }
            if (stopButton.isEnabled()) {
              browserButton.setEnabled(true);
              browserMenuItem.setEnabled(true);
              frame.setCursor(Cursor.getDefaultCursor());
            }
          }
        }
;
        thread.start();
      }
 else       if ("Stop".equals(e.getActionCommand())) {
        stopApplication();
        frame.setIconImage(offIcon.getImage());
        trayIcon.setIcon(offIcon);
        frame.setCursor(Cursor.getDefaultCursor());
        browserButton.setEnabled(false);
        startButton.setEnabled(true);
        stopButton.setEnabled(false);
        browserMenuItem.setEnabled(false);
        startMenuItem.setEnabled(true);
        stopMenuItem.setEnabled(false);
      }
 else       if ("Launch Admin".equals(e.getActionCommand())) {
        launchBrowser();
      }
 else       if ("Quit".equals(e.getActionCommand())) {
        stopApplication();
        System.exit(0);
      }
 else       if ("Hide/Show".equals(e.getActionCommand()) || "PressAction".equals(e.getActionCommand())) {
        if (frame.isVisible()) {
          frame.setVisible(false);
          frame.setState(Frame.ICONIFIED);
          showMenuItem.setText("Show");
        }
 else {
          frame.setVisible(true);
          frame.setState(Frame.NORMAL);
          showMenuItem.setText("Hide");
        }
      }
    }
  }
;
  startButton.addActionListener(actionListener);
  stopButton.addActionListener(actionListener);
  browserButton.addActionListener(actionListener);
  quitButton.addActionListener(actionListener);
  quitMenuItem.addActionListener(actionListener);
  browserMenuItem.addActionListener(actionListener);
  stopMenuItem.addActionListener(actionListener);
  startMenuItem.addActionListener(actionListener);
  showMenuItem.addActionListener(actionListener);
  trayIcon=new TrayIcon(offIcon,"Jive Messenger",menu);
  trayIcon.setIconAutoSize(true);
  trayIcon.addActionListener(actionListener);
  tray.addTrayIcon(trayIcon);
  frame.addWindowListener(new WindowAdapter(){
    public void windowClosing(    WindowEvent e){
      stopApplication();
      System.exit(0);
    }
    public void windowIconified(    WindowEvent e){
      frame.setVisible(false);
      showMenuItem.setText("Show");
    }
  }
);
  frame.getContentPane().add(mainPanel);
  frame.pack();
  frame.setResizable(false);
  GraphicUtils.centerWindowOnScreen(frame);
  frame.setVisible(true);
  startButton.doClick();
}
