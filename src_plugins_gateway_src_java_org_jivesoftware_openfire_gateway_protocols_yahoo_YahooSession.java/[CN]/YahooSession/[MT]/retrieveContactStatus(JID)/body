{
  if (isLoggedIn()) {
    YahooUser user=yahooSession.getUser(jid.getNode());
    Presence p=new Presence();
    p.setTo(getJID());
    if (user != null) {
      p.setFrom(getTransport().convertIDToJID(user.getId()));
      String custommsg=user.getCustomStatusMessage();
      if (custommsg != null) {
        p.setStatus(custommsg);
      }
      ((YahooTransport)getTransport()).setUpPresencePacket(p,user.getStatus());
    }
 else {
      p.setFrom(jid);
      p.setError(PacketError.Condition.forbidden);
    }
    getTransport().sendPacket(p);
  }
}
