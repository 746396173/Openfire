{
  if (auditManager.isEnabled()) {
    if (packet instanceof Message) {
      if (auditManager.isAuditMessage()) {
        writePacket(packet);
      }
    }
 else     if (packet instanceof Presence) {
      if (auditManager.isAuditPresence()) {
        writePacket(packet);
      }
    }
 else     if (packet instanceof IQ) {
      if (auditManager.isAuditIQ()) {
        writePacket(packet);
      }
    }
  }
}
