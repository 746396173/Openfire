{
  if (enabled == clusteringEnabled) {
    return;
  }
  JiveGlobals.setProperty(CLUSTER_PROPERTY_NAME,String.valueOf(enabled));
  if (!enabled) {
    clusteringEnabled=false;
    CacheFactoryStrategy clusteredFactory=cacheFactoryStrategy;
    cacheFactoryStrategy=(CacheFactoryStrategy)Class.forName(localCacheFactoryClass).newInstance();
    for (    String cacheName : caches.keySet()) {
      CacheWrapper wrapper=(CacheWrapper)caches.get(cacheName);
      wrapper.setWrappedCache(cacheFactoryStrategy.createCache(cacheName));
    }
    clusteredFactory.stopCluster();
    fireClusteringStopped();
  }
 else {
    startClustering();
  }
}
