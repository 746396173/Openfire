{
  PluginManager pluginManager=XMPPServer.getInstance().getPluginManager();
  Plugin plugin=pluginManager.getPlugin("hazelcast");
  if (plugin == null) {
    plugin=pluginManager.getPlugin("clustering");
    if (plugin == null) {
      plugin=pluginManager.getPlugin("enterprise");
    }
  }
  PluginClassLoader pluginLoader=pluginManager.getPluginClassloader(plugin);
  if (pluginLoader != null) {
    return pluginLoader;
  }
 else {
    Log.debug("CacheFactory - Unable to find a Plugin that provides clustering support.");
    return Thread.currentThread().getContextClassLoader();
  }
}
