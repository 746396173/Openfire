{
  try {
    CacheFactoryStrategy clusteredFactory=cacheFactoryStrategy;
    cacheFactoryStrategy=(CacheFactoryStrategy)Class.forName(localCacheFactoryClass).newInstance();
    for (    String cacheName : caches.keySet()) {
      CacheWrapper wrapper=(CacheWrapper)caches.get(cacheName);
      wrapper.setWrappedCache(cacheFactoryStrategy.createCache(cacheName));
    }
    clusteringEnabled=false;
    XMPPServer.getInstance().setNodeID(null);
    clusteredFactory.stopCluster();
    fireClusteringStopped();
  }
 catch (  Exception e) {
    Log.error("Unable to stop clustering - continuing in clustered mode",e);
  }
}
