{
  CallIdHeader ch=(CallIdHeader)req.getHeader("Call-ID");
  ToHeader th=(ToHeader)req.getHeader("To");
  FromHeader fh=(FromHeader)req.getHeader("From");
  rl=new LinkedList<Address>();
  this.callId=ch.getCallId();
  ContactHeader cont=(ContactHeader)req.getHeader(ContactHeader.NAME);
  if (cont != null) {
    this.contact=cont.getAddress().getURI().toString();
  }
  if (rl.isEmpty()) {
    ListIterator<?> rrl=req.getHeaders(RecordRouteHeader.NAME);
    while (rrl.hasNext()) {
      RecordRouteHeader rrh=(RecordRouteHeader)rrl.next();
      rl.add(rrh.getAddress());
    }
  }
  remoteTag=fh.getTag();
  remoteParty=fh.getAddress();
  localTag=th.getTag();
  localParty=th.getAddress();
  if (localTag == null) {
    localTag=Integer.toString((int)(Math.random() * 100000));
  }
  ExpiresHeader eh=(ExpiresHeader)req.getHeader(ExpiresHeader.NAME);
  this.expires=System.currentTimeMillis() + (eh.getExpires() * 1000);
  cseq=1;
}
