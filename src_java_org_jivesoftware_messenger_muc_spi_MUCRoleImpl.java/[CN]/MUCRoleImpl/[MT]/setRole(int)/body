{
  if (MUCRole.OWNER == affiliation || MUCRole.ADMINISTRATOR == affiliation) {
    if (MUCRole.MODERATOR != newRole) {
      throw new NotAllowedException();
    }
  }
  if (MUCRole.MODERATOR == role && MUCRole.NONE_ROLE == newRole) {
    throw new NotAllowedException();
  }
  role=newRole;
  if (MUCRole.NONE_ROLE == role) {
    try {
      presence.setAvailable(false);
      presence.setVisible(false);
    }
 catch (    UnauthorizedException e) {
      Log.error(LocaleUtils.getLocalizedString("admin.error"),e);
    }
  }
  calculateExtendedInformation();
}
