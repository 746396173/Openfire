{
  if (dataSourceName == null || dataSourceName.equals("")) {
    error("No name specified for DataSource. JNDI lookup will fail",null);
    return;
  }
  try {
    Properties contextProperties=new Properties();
    for (int i=0; i < jndiPropertyKeys.length; i++) {
      String k=jndiPropertyKeys[i];
      String v=JiveGlobals.getJiveProperty(k);
      if (v != null) {
        contextProperties.setProperty(k,v);
      }
    }
    Context context=null;
    if (contextProperties.size() > 0) {
      context=new InitialContext(contextProperties);
    }
 else {
      context=new InitialContext();
    }
    dataSource=(DataSource)context.lookup(dataSourceName);
  }
 catch (  Exception e) {
    error("Could not lookup DataSource at '" + dataSourceName + "'",e);
  }
}
