{
  TLSStatus status=null;
  if (tlsEngineResult != null && tlsEngineResult.getStatus() == Status.BUFFER_UNDERFLOW) {
    status=TLSStatus.UNDERFLOW;
  }
 else {
    if (tlsEngineResult != null && tlsEngineResult.getStatus() == Status.CLOSED) {
      status=TLSStatus.CLOSED;
    }
 else {
switch (tlsEngine.getHandshakeStatus()) {
case NEED_WRAP:
        status=TLSStatus.NEED_WRITE;
      break;
case NEED_UNWRAP:
    status=TLSStatus.NEED_READ;
  break;
default :
status=TLSStatus.OK;
break;
}
}
}
return status;
}
