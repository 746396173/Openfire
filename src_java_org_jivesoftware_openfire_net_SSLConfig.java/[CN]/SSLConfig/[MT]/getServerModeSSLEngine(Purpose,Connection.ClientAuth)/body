{
  final SSLEngine sslEngine=getSSLEngine(purpose);
  sslEngine.setUseClientMode(false);
switch (clientAuth) {
case needed:
    sslEngine.setNeedClientAuth(true);
  break;
case wanted:
sslEngine.setWantClientAuth(true);
break;
case disabled:
sslEngine.setWantClientAuth(false);
break;
}
return sslEngine;
}
