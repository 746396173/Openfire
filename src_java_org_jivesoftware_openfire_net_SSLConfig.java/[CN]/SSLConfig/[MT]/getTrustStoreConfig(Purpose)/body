{
  if (purpose == null) {
    throw new IllegalArgumentException("Argument 'purpose' cannot be null.");
  }
  final TrustStoreConfig config=trustStoresByLocation.get(trustStoreLocationByPurpose.get(purpose));
  if (config == null) {
    throw new IllegalStateException("Cannot retrieve trust store for " + purpose);
  }
  return config;
}
