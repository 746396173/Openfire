{
  if (heartbeatCount >= 2) {
    log.warn("No response after 2 heartbeats, closing connection");
    gateway.closeConnection(getHostPort());
  }
 else {
    try {
      if (gateway.isConnected(getHostPort())) {
        gateway.sendMessage(StampyHeartbeatContainer.HB1,getHostPort());
        log.debug("Sent heartbeat");
        start();
        heartbeatCount++;
      }
    }
 catch (    Exception e) {
      log.error("Could not send heartbeat",e);
    }
  }
}
