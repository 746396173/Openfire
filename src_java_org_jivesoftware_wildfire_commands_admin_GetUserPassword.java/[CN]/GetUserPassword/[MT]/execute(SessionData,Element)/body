{
  Element note=command.addElement("note");
  if (!AuthFactory.getAuthProvider().supportsPasswordRetrieval()) {
    note.addAttribute("type","error");
    note.setText("Retrieval of passwords is not supported.");
    return;
  }
  JID account=new JID(data.getData().get("accountjid").get(0));
  if (!XMPPServer.getInstance().isLocal(account)) {
    note.addAttribute("type","error");
    note.setText("Cannot get password of remote user.");
    return;
  }
  String password;
  try {
    password=AuthFactory.getAuthProvider().getPassword(account.getNode());
  }
 catch (  UserNotFoundException e) {
    note.addAttribute("type","error");
    note.setText("User does not exist.");
    return;
  }
  DataForm form=new DataForm(DataForm.Type.result);
  FormField field=form.addField();
  field.setType(FormField.Type.hidden);
  field.setVariable("FORM_TYPE");
  field.addValue("http://jabber.org/protocol/admin");
  field=form.addField();
  field.setVariable("accountjid");
  field.addValue(account.toString());
  field=form.addField();
  field.setVariable("password");
  field.addValue(password);
  command.add(form.getElement());
  note.addAttribute("type","info");
  note.setText("Operation finished successfully");
}
