{
  final List list=new ArrayList();
  File classes=new File(dir + File.separator + "classes"+ File.separator);
  if (classes.exists()) {
    list.add(classes.toURL());
  }
  File lib=new File(dir + File.separator + "lib"+ File.separator);
  File[] jars=lib.listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.endsWith(".jar") || name.endsWith(".zip");
    }
  }
);
  if (jars != null) {
    for (int i=0; i < jars.length; i++) {
      if (jars[i] != null && jars[i].isFile()) {
        list.add(jars[i].toURL());
      }
    }
  }
  Iterator urls=list.iterator();
  URL[] urlArray=new URL[list.size()];
  for (int i=0; urls.hasNext(); i++) {
    urlArray[i]=(URL)urls.next();
  }
  classLoader=new URLClassLoader(urlArray,findParentClassLoader());
  Thread.currentThread().setContextClassLoader(classLoader);
}
