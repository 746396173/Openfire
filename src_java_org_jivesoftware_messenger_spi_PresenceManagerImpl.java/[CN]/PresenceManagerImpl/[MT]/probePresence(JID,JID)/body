{
  try {
    Component component=getPresenceComponent(probee);
    if (server.isLocal(probee)) {
      if (probee.getNode() != null && !"".equals(probee.getNode())) {
        Collection<ClientSession> sessions=sessionManager.getSessions(probee.getNode());
        for (        ClientSession session : sessions) {
          Presence presencePacket=session.getPresence().createCopy();
          presencePacket.setFrom(session.getAddress());
          presencePacket.setTo(prober);
          try {
            deliverer.deliver(presencePacket);
          }
 catch (          Exception e) {
            Log.error(LocaleUtils.getLocalizedString("admin.error"),e);
          }
        }
      }
    }
 else     if (component != null) {
      Presence presence=new Presence();
      presence.setType(Presence.Type.probe);
      presence.setFrom(prober);
      presence.setTo(probee);
      component.processPacket(presence);
    }
 else {
      String serverDomain=server.getServerInfo().getName();
      if (!probee.getDomain().contains(serverDomain)) {
      }
 else {
        componentManager.addPresenceRequest(prober,probee);
      }
    }
  }
 catch (  Exception e) {
    Log.error(LocaleUtils.getLocalizedString("admin.error"),e);
  }
}
