{
  List<Packet> reply=new ArrayList<Packet>();
  JID from=packet.getFrom();
  if (packet.getTo().getNode() == null) {
    IQ result=IQ.createResultIQ(packet);
    Element response=DocumentHelper.createElement(QName.get("query",DISCO_INFO));
    response.addElement("identity").addAttribute("category","gateway").addAttribute("type",this.transportType.toString()).addAttribute("name",this.description);
    response.addElement("feature").addAttribute("var",IQ_GATEWAY);
    response.addElement("feature").addAttribute("var",IQ_REGISTER);
    response.addElement("feature").addAttribute("var",IQ_VERSION);
    Collection<Registration> registrations=registrationManager.getRegistrations(from,this.transportType);
    if (!registrations.isEmpty()) {
      response.addElement("feature").addAttribute("var",IQ_REGISTERED);
    }
    result.setChildElement(response);
    reply.add(result);
  }
  return reply;
}
