{
  boolean hasMatch=false;
  if (msg.getSubject() != null) {
    if (hasMatch(msg.getSubject())) {
      hasMatch=true;
      if (isMaskingContent()) {
        String newSubject=replaceContent(msg.getSubject());
        msg.setSubject(newSubject);
      }
    }
  }
  if (msg.getBody() != null) {
    if (hasMatch(msg.getBody())) {
      hasMatch=true;
      if (isMaskingContent()) {
        String newBody=replaceContent(msg.getBody());
        msg.setBody(newBody);
      }
    }
  }
  return hasMatch;
}
