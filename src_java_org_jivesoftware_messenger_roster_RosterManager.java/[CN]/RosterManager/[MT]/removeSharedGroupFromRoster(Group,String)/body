{
  Collection<String> users=new HashSet<String>(group.getMembers());
  users.addAll(group.getAdmins());
  Roster userRoster=(Roster)CacheManager.getCache("username2roster").get(username);
  String groupName=group.getProperties().get("sharedRoster.displayName");
  for (  String userToRemove : users) {
    Roster roster=(Roster)CacheManager.getCache("username2roster").get(userToRemove);
    if (roster != null) {
      roster.deleteSharedUser(groupName,username);
    }
    if (userRoster != null) {
      try {
        User user=UserManager.getInstance().getUser(userToRemove);
        Collection<Group> groups=GroupManager.getInstance().getGroups(user);
        userRoster.deleteSharedUser(userToRemove,groups,group);
      }
 catch (      UserNotFoundException e) {
      }
    }
  }
}
