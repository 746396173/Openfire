{
  if (connection == null) {
    throw new IllegalArgumentException("Connection cannot be null.");
  }
  if (isPoll) {
    checkPollingInterval();
  }
  if (isSecure && !connection.isSecure()) {
    throw new HttpBindException("Session was started from secure connection, all " + "connections on this session must be secured.",false,403);
  }
  connection.setSession(this);
  if (hold <= 0 || (pendingElements.size() > 0 && connection.getRequestId() == lastRequestID + 1)) {
    String deliverable=createDeliverable(pendingElements);
    try {
      deliver(connection,deliverable);
      lastRequestID=connection.getRequestId();
      pendingElements.clear();
    }
 catch (    HttpConnectionClosedException he) {
      throw he;
    }
  }
 else {
    int connectionsToClose=(connectionQueue.size() + 1) - hold;
    for (int i=0; i < connectionsToClose; i++) {
      HttpConnection toClose=connectionQueue.get(i);
      toClose.close();
    }
  }
  connectionQueue.add(connection);
  Collections.sort(connectionQueue,connectionComparator);
  fireConnectionOpened(connection);
}
