{
  if (isClosed) {
    return;
  }
  isClosed=true;
  if (pendingElements.size() > 0) {
    failDelivery();
  }
  while (connectionQueue.size() > 0) {
    HttpConnection toClose=connectionQueue.remove();
    toClose.close();
    fireConnectionClosed(toClose);
  }
  for (  SessionListener listener : listeners) {
    listener.sessionClosed(this);
  }
  this.listeners.clear();
}
