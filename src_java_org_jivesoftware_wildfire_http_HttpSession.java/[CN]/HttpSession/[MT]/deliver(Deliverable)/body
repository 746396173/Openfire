{
  String deliverable=createDeliverable(Arrays.asList(stanza));
  boolean delivered=false;
  while (!delivered && connectionQueue.hasConnectionWaiting()) {
    HttpConnection connection=connectionQueue.getConnection();
    try {
      deliver(connection,deliverable);
      delivered=true;
      fireConnectionClosed(connection);
    }
 catch (    HttpConnectionClosedException e) {
    }
  }
  if (!delivered) {
    pendingElements.add(stanza);
  }
}
