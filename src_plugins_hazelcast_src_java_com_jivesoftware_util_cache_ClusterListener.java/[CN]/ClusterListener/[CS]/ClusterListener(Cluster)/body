{
  this.cluster=cluster;
  for (  Member member : cluster.getMembers()) {
    clusterNodesInfo.put(member.getUuid(),new HazelcastClusterNodeInfo(member,cluster.getClusterTime()));
  }
  C2SCache=CacheFactory.createCache(RoutingTableImpl.C2S_CACHE_NAME);
  anonymousC2SCache=CacheFactory.createCache(RoutingTableImpl.ANONYMOUS_C2S_CACHE_NAME);
  S2SCache=CacheFactory.createCache(RoutingTableImpl.S2S_CACHE_NAME);
  componentsCache=CacheFactory.createCache(RoutingTableImpl.COMPONENT_CACHE_NAME);
  sessionInfoCache=CacheFactory.createCache(SessionManager.C2S_INFO_CACHE_NAME);
  componentSessionsCache=CacheFactory.createCache(SessionManager.COMPONENT_SESSION_CACHE_NAME);
  multiplexerSessionsCache=CacheFactory.createCache(SessionManager.CM_CACHE_NAME);
  incomingServerSessionsCache=CacheFactory.createCache(SessionManager.ISS_CACHE_NAME);
  directedPresencesCache=CacheFactory.createCache(PresenceUpdateHandler.PRESENCE_CACHE_NAME);
  addEntryListener(C2SCache,new CacheListener(this,C2SCache.getName()));
  addEntryListener(anonymousC2SCache,new CacheListener(this,anonymousC2SCache.getName()));
  addEntryListener(S2SCache,new CacheListener(this,S2SCache.getName()));
  addEntryListener(componentsCache,new ComponentCacheListener());
  addEntryListener(sessionInfoCache,new CacheListener(this,sessionInfoCache.getName()));
  addEntryListener(componentSessionsCache,new CacheListener(this,componentSessionsCache.getName()));
  addEntryListener(multiplexerSessionsCache,new CacheListener(this,multiplexerSessionsCache.getName()));
  addEntryListener(incomingServerSessionsCache,new CacheListener(this,incomingServerSessionsCache.getName()));
  addEntryListener(directedPresencesCache,new DirectedPresenceListener());
  joinCluster();
}
