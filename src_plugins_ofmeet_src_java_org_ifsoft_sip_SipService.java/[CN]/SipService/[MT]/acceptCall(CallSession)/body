{
  try {
    Request req=cs.inviteTransaction.getRequest();
    Response resp=messageFactory.createResponse(Response.OK,cs.inviteTransaction.getRequest());
    ContentTypeHeader cth=headerFactory.createContentTypeHeader("application","sdp");
    Object sdp=cs.buildSDP(false);
    ToHeader th=(ToHeader)req.getHeader("To");
    String dest=((SipURI)th.getAddress().getURI()).getUser();
    ListeningPoint lp=sipProvider.getListeningPoint(ListeningPoint.UDP);
    Address localAddress=addressFactory.createAddress("sip:" + dest + "@"+ lp.getIPAddress()+ ":"+ lp.getPort());
    ContactHeader ch=headerFactory.createContactHeader(localAddress);
    AllowHeader allowHeader=headerFactory.createAllowHeader("INVITE, ACK, CANCEL, OPTIONS, BYE, UPDATE, NOTIFY, MESSAGE, SUBSCRIBE, INFO");
    resp.addHeader(allowHeader);
    resp.addHeader(ch);
    UserAgentHeader userAgent=(UserAgentHeader)headerFactory.createHeader(UserAgentHeader.NAME,agentName);
    resp.setHeader(userAgent);
    resp.setContent(sdp,cth);
    cs.inviteTransaction.sendResponse(resp);
  }
 catch (  ParseException e) {
    Log.error("Error accepting call",e);
    return false;
  }
catch (  SipException e) {
    Log.error("Error accepting call",e);
    return false;
  }
catch (  InvalidArgumentException e) {
    Log.error("Error accepting call",e);
    return false;
  }
  return true;
}
